// Base styles for FNX components
@use "sass:map";
@use 'variables' as *;
@use 'mixins' as *;

// Generate CSS custom properties for themes
:root,
:root[data-theme="light"],
.light {
  @include theme-colors(light);
}

:root[data-theme="dark"],
.dark {
  @include theme-colors(dark);
}

// Base design tokens as CSS custom properties
:root {
  // Transition settings
  --fnx-transition-duration: #{$transition-duration};
  --fnx-transition-timing: #{$transition-timing};
  
  // Border radius
  @each $key, $value in $border-radius {
    --fnx-border-radius-#{$key}: #{$value};
  }
  
  // Spacing
  @each $key, $value in $spacing {
    --fnx-spacing-#{$key}: #{$value};
  }
  
  // Font sizes
  @each $key, $value in $font-sizes {
    --fnx-font-size-#{$key}: #{$value};
  }
  
  // Font weights
  @each $key, $value in $font-weights {
    --fnx-font-weight-#{$key}: #{$value};
  }
  
  // Z-index layers
  @each $key, $value in $z-index {
    --fnx-z-#{$key}: #{$value};
  }
}

// Reset and base styles
*,
*::before,
*::after {
  box-sizing: border-box;
}

// Base body styles
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: var(--fnx-background);
  color: var(--fnx-text-primary);
  margin: 0;
  padding: 0;
}

// Focus styles
* {
  &:focus {
    @include focus-ring;
  }
  
  &:focus:not(:focus-visible) {
    outline: none;
  }
  
  &:focus-visible {
    @include focus-ring;
  }
}

// Common utility classes
.fnx-sr-only {
  @include visually-hidden;
}

.fnx-transition {
  @include fnx-transition;
}

.fnx-flex-center {
  @include flex-center;
}

.fnx-truncate {
  @include truncate;
}

// Form field base styles - Zoho Books Style
.fnx-field {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  width: 100%;
  
  &-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.25rem;
    
    &.required::after {
      content: ' *';
      color: #ef4444;
    }
  }
  
  &-error {
    font-size: 0.75rem;
    color: #ef4444;
    margin-top: 0.25rem;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 0.25rem;
  }
  
  &-help {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
  }
  
  // Field states
  &--error {
    .fnx-field-label {
      color: #ef4444;
    }
  }
  
  &--success {
    .fnx-field-label {
      color: #10b981;
    }
  }
  
  &--disabled {
    opacity: 0.6;
    
    .fnx-field-label {
      color: #9ca3af;
    }
  }
  
  &--loading {
    position: relative;
  }
}

// Loading spinner
.fnx-spinner {
  @include spinner;
}

// Keyframe animations
@keyframes fnx-spin {
  to {
    transform: rotate(360deg);
  }
}

// Error icon
.fnx-error-icon {
  @include icon-size(16px);
  color: var(--fnx-error-500);
}

// Success icon
.fnx-success-icon {
  @include icon-size(16px);
  color: var(--fnx-success-500);
}

// Smooth transitions for theme switching
* {
  @include fnx-transition(background-color, border-color, color, box-shadow);
}

// Disable transitions during theme initialization to prevent flash
.theme-transition-disabled * {
  transition: none !important;
}

// Generate spacing utilities
@include generate-spacing-utilities('fnx-m', 'margin');
@include generate-spacing-utilities('fnx-mt', 'margin-top');
@include generate-spacing-utilities('fnx-mr', 'margin-right');
@include generate-spacing-utilities('fnx-mb', 'margin-bottom');
@include generate-spacing-utilities('fnx-ml', 'margin-left');
@include generate-spacing-utilities('fnx-mx', 'margin-left', 'margin-right');
@include generate-spacing-utilities('fnx-my', 'margin-top', 'margin-bottom');

@include generate-spacing-utilities('fnx-p', 'padding');
@include generate-spacing-utilities('fnx-pt', 'padding-top');
@include generate-spacing-utilities('fnx-pr', 'padding-right');
@include generate-spacing-utilities('fnx-pb', 'padding-bottom');
@include generate-spacing-utilities('fnx-pl', 'padding-left');
@include generate-spacing-utilities('fnx-px', 'padding-left', 'padding-right');
@include generate-spacing-utilities('fnx-py', 'padding-top', 'padding-bottom');

// Responsive utilities
@each $breakpoint-name, $breakpoint-value in $breakpoints {
  @include breakpoint($breakpoint-name) {
    .fnx-hidden-#{$breakpoint-name} {
      display: none;
    }
    
    .fnx-block-#{$breakpoint-name} {
      display: block;
    }
    
    .fnx-flex-#{$breakpoint-name} {
      display: flex;
    }
    
    .fnx-grid-#{$breakpoint-name} {
      display: grid;
    }
  }
}

// Text utilities
.fnx-text {
  &-left { text-align: left; }
  &-center { text-align: center; }
  &-right { text-align: right; }
  &-justify { text-align: justify; }
  
  &-primary { color: var(--fnx-text-primary); }
  &-secondary { color: var(--fnx-text-secondary); }
  &-muted { color: var(--fnx-text-muted); }
  &-inverse { color: var(--fnx-text-inverse); }
  
  @each $key, $value in $font-sizes {
    &-#{$key} { font-size: $value; }
  }
  
  @each $key, $value in $font-weights {
    &-#{$key} { font-weight: $value; }
  }
}

// Background utilities
.fnx-bg {
  &-background { background-color: var(--fnx-background); }
  &-surface { background-color: var(--fnx-surface); }
  &-surface-hover { background-color: var(--fnx-surface-hover); }
  &-surface-active { background-color: var(--fnx-surface-active); }
  
  &-primary { background-color: var(--fnx-primary-500); }
  &-success { background-color: var(--fnx-success-500); }
  &-warning { background-color: var(--fnx-warning-500); }
  &-error { background-color: var(--fnx-error-500); }
}

// Border utilities
.fnx-border {
  border: 1px solid var(--fnx-border-normal);
  
  &-light { border-color: var(--fnx-border-light); }
  &-normal { border-color: var(--fnx-border-normal); }
  &-strong { border-color: var(--fnx-border-strong); }
  
  &-primary { border-color: var(--fnx-primary-500); }
  &-success { border-color: var(--fnx-success-500); }
  &-warning { border-color: var(--fnx-warning-500); }
  &-error { border-color: var(--fnx-error-500); }
  
  @each $key, $value in $border-radius {
    &-radius-#{$key} { border-radius: $value; }
  }
}

// Shadow utilities
.fnx-shadow {
  @each $key, $value in $shadows {
    &-#{$key} { box-shadow: $value; }
  }
}
